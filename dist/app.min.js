/**
 * jscs-config-generator
 * @author Alexander Burtsev, http://burtsev.me, 2014
 * @license MIT
 */
(function() {function Rule(a){return this instanceof Rule?void(this.name=a):new Rule(a)}function Iterator(a){return this instanceof Iterator?(this.tree=a||[],this.rules=[],this.idx=-1,void this.start()):new Iterator(a)}function MDItem(a){return this instanceof MDItem?void("object"==typeof a&&(this.data=a,this.type=a[0])):new MDItem(a)}Rule.prototype={cleanValue:function(a,b){return("example"===a||"valid"===a||"invalid"===a)&&(b=b.replace(/^`?js\n/,"").replace(/\n`$/,"")),b},set:function(a,b){this[a]=(void 0===this[a]?"":this[a])+this.cleanValue(a,b)}},Iterator.prototype={STATE_START:"start",STATE_RULES:"rules",STATE_DONE:"done",RULE_STATE_START:"start",RULE_STATE_EXAMPLE:"example",RULE_STATE_VALID:"valid",RULE_STATE_INVALID:"invalid",start:function(){for(var a,b,c=this.STATE_START,d=this.RULE_STATE_START;(a=this.next())&&c!==this.STATE_DONE;)switch(c){case this.STATE_START:c=2===a.isHeader()&&"Rules"===a.text()&&this.STATE_RULES||c;break;case this.STATE_RULES:c=2===a.isHeader()&&this.STATE_DONE||c,3===a.isHeader()?(b=Rule(a.text()),d=this.RULE_STATE_START,this.rules.push(b)):4===a.isHeader()&&"Example"===a.text()?d=this.RULE_STATE_EXAMPLE:5===a.isHeader()&&"Valid"===a.text()?d=this.RULE_STATE_VALID:5===a.isHeader()&&"Invalid"===a.text()?d=this.RULE_STATE_INVALID:a.isParagraph()&&this.setRuleProperty(d,a,b)}},setRuleProperty:function(a,b,c){var d,e=b.text();switch(a){case this.RULE_STATE_START:break;case this.RULE_STATE_EXAMPLE:d=this.RULE_STATE_EXAMPLE;break;case this.RULE_STATE_VALID:d=this.RULE_STATE_VALID;break;case this.RULE_STATE_INVALID:d=this.RULE_STATE_INVALID}d&&c.set(d,e)},next:function(){this.idx++;var a=this.tree[this.idx];return a?MDItem(a):!1}},MDItem.prototype={isHeader:function(){return"header"===this.type&&this.data[1].level},isParagraph:function(){return"para"===this.type},text:function(a){var b="";if(a=a||this.data,!a)return"";for(var c,d=1;d<a.length;d++)c=a[d],"string"==typeof c?b+=c:c instanceof Array&&(b+=this.text(c));return b}};var RuleModel=Backbone.Model.extend({defaults:{name:"",description:"",idx:0,valid:"",invalid:"",values:[]},initialize:function(){}}),RuleList=Backbone.Collection.extend({model:RuleModel}),RuleView=Backbone.View.extend({tagName:"div",className:"card swiper-slide",template:_.template($("#tpl-card").html()),initialize:function(){this.on("added",this.fitText)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},fitText:function(){this.$(".js-fit-text").textfill({minFontPixels:10,maxFontPixels:28,widthOnly:!0})}});jQuery(function(a){"use strict";a.ajaxSetup({cache:!1,dataType:"text"});var b="src/README.md";a.get(b).done(function(a){try{var b=markdown.parse(a),d=Iterator(b).rules;new c(d)}catch(e){console.log("Unexpected error",e)}}).fail(function(){});var c=Backbone.View.extend({el:a(".js-app"),initialize:function(a){this._rules=this.$(".js-rules"),this._swiper=this.$(".js-swiper"),this.list=new RuleList,this.listenTo(this.list,"add",this.addRule),this.list.add(a),this.initSwiper()},initSwiper:function(){new Swiper(this._swiper.get(0),{mode:"horizontal",calculateHeight:!0,simulateTouch:!1,keyboardControl:!0,loop:!1,onFirstInit:this.fitSwiperHeight.bind(this),onSlideChangeEnd:this.fitSwiperHeight.bind(this)})},addRule:function(a){var b=new RuleView({model:a});this._rules.append(b.render().el),b.trigger("added")},fitSwiperHeight:function(b){var c,d=a(b.activeSlide());d.css("height","auto"),c=d.height(),this._rules.css("height",c)}})});})();